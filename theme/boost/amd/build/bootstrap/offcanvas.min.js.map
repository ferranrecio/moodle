{"version":3,"file":"offcanvas.min.js","sources":["../../src/bootstrap/offcanvas.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.0.2): offcanvas.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport {\n  defineJQueryPlugin,\n  getElementFromSelector,\n  isDisabled,\n  isVisible,\n  typeCheckConfig\n} from './util/index'\nimport ScrollBarHelper from './util/scrollbar'\nimport EventHandler from './dom/event-handler'\nimport BaseComponent from './base-component'\nimport SelectorEngine from './dom/selector-engine'\nimport Manipulator from './dom/manipulator'\nimport Backdrop from './util/backdrop'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'offcanvas'\nconst DATA_KEY = 'bs.offcanvas'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\nconst ESCAPE_KEY = 'Escape'\n\nconst Default = {\n  backdrop: true,\n  keyboard: true,\n  scroll: false\n}\n\nconst DefaultType = {\n  backdrop: 'boolean',\n  keyboard: 'boolean',\n  scroll: 'boolean'\n}\n\nconst CLASS_NAME_SHOW = 'show'\nconst OPEN_SELECTOR = '.offcanvas.show'\n\nconst EVENT_SHOW = `show${EVENT_KEY}`\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\nconst EVENT_HIDE = `hide${EVENT_KEY}`\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\nconst EVENT_FOCUSIN = `focusin${EVENT_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\nconst EVENT_CLICK_DISMISS = `click.dismiss${EVENT_KEY}`\nconst EVENT_KEYDOWN_DISMISS = `keydown.dismiss${EVENT_KEY}`\n\nconst SELECTOR_DATA_DISMISS = '[data-bs-dismiss=\"offcanvas\"]'\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"offcanvas\"]'\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Offcanvas extends BaseComponent {\n  constructor(element, config) {\n    super(element)\n\n    this._config = this._getConfig(config)\n    this._isShown = false\n    this._backdrop = this._initializeBackDrop()\n    this._addEventListeners()\n  }\n\n  // Getters\n\n  static get NAME() {\n    return NAME\n  }\n\n  static get Default() {\n    return Default\n  }\n\n  // Public\n\n  toggle(relatedTarget) {\n    return this._isShown ? this.hide() : this.show(relatedTarget)\n  }\n\n  show(relatedTarget) {\n    if (this._isShown) {\n      return\n    }\n\n    const showEvent = EventHandler.trigger(this._element, EVENT_SHOW, { relatedTarget })\n\n    if (showEvent.defaultPrevented) {\n      return\n    }\n\n    this._isShown = true\n    this._element.style.visibility = 'visible'\n\n    this._backdrop.show()\n\n    if (!this._config.scroll) {\n      new ScrollBarHelper().hide()\n      this._enforceFocusOnElement(this._element)\n    }\n\n    this._element.removeAttribute('aria-hidden')\n    this._element.setAttribute('aria-modal', true)\n    this._element.setAttribute('role', 'dialog')\n    this._element.classList.add(CLASS_NAME_SHOW)\n\n    const completeCallBack = () => {\n      EventHandler.trigger(this._element, EVENT_SHOWN, { relatedTarget })\n    }\n\n    this._queueCallback(completeCallBack, this._element, true)\n  }\n\n  hide() {\n    if (!this._isShown) {\n      return\n    }\n\n    const hideEvent = EventHandler.trigger(this._element, EVENT_HIDE)\n\n    if (hideEvent.defaultPrevented) {\n      return\n    }\n\n    EventHandler.off(document, EVENT_FOCUSIN)\n    this._element.blur()\n    this._isShown = false\n    this._element.classList.remove(CLASS_NAME_SHOW)\n    this._backdrop.hide()\n\n    const completeCallback = () => {\n      this._element.setAttribute('aria-hidden', true)\n      this._element.removeAttribute('aria-modal')\n      this._element.removeAttribute('role')\n      this._element.style.visibility = 'hidden'\n\n      if (!this._config.scroll) {\n        new ScrollBarHelper().reset()\n      }\n\n      EventHandler.trigger(this._element, EVENT_HIDDEN)\n    }\n\n    this._queueCallback(completeCallback, this._element, true)\n  }\n\n  dispose() {\n    this._backdrop.dispose()\n    super.dispose()\n    EventHandler.off(document, EVENT_FOCUSIN)\n  }\n\n  // Private\n\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...Manipulator.getDataAttributes(this._element),\n      ...(typeof config === 'object' ? config : {})\n    }\n    typeCheckConfig(NAME, config, DefaultType)\n    return config\n  }\n\n  _initializeBackDrop() {\n    return new Backdrop({\n      isVisible: this._config.backdrop,\n      isAnimated: true,\n      rootElement: this._element.parentNode,\n      clickCallback: () => this.hide()\n    })\n  }\n\n  _enforceFocusOnElement(element) {\n    EventHandler.off(document, EVENT_FOCUSIN) // guard against infinite focus loop\n    EventHandler.on(document, EVENT_FOCUSIN, event => {\n      if (document !== event.target &&\n        element !== event.target &&\n        !element.contains(event.target)) {\n        element.focus()\n      }\n    })\n    element.focus()\n  }\n\n  _addEventListeners() {\n    EventHandler.on(this._element, EVENT_CLICK_DISMISS, SELECTOR_DATA_DISMISS, () => this.hide())\n\n    EventHandler.on(this._element, EVENT_KEYDOWN_DISMISS, event => {\n      if (this._config.keyboard && event.key === ESCAPE_KEY) {\n        this.hide()\n      }\n    })\n  }\n\n  // Static\n\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = Offcanvas.getOrCreateInstance(this, config)\n\n      if (typeof config !== 'string') {\n        return\n      }\n\n      if (data[config] === undefined || config.startsWith('_') || config === 'constructor') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config](this)\n    })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\n  const target = getElementFromSelector(this)\n\n  if (['A', 'AREA'].includes(this.tagName)) {\n    event.preventDefault()\n  }\n\n  if (isDisabled(this)) {\n    return\n  }\n\n  EventHandler.one(target, EVENT_HIDDEN, () => {\n    // focus on trigger when it is closed\n    if (isVisible(this)) {\n      this.focus()\n    }\n  })\n\n  // avoid conflict when clicking a toggler of an offcanvas, while another is open\n  const allReadyOpen = SelectorEngine.findOne(OPEN_SELECTOR)\n  if (allReadyOpen && allReadyOpen !== target) {\n    Offcanvas.getInstance(allReadyOpen).hide()\n  }\n\n  const data = Offcanvas.getOrCreateInstance(target)\n  data.toggle(this)\n})\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, () =>\n  SelectorEngine.find(OPEN_SELECTOR).forEach(el => Offcanvas.getOrCreateInstance(el).show())\n)\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n */\n\ndefineJQueryPlugin(Offcanvas)\n\nexport default Offcanvas\n"],"names":["EVENT_KEY","EVENT_LOAD_DATA_API","Default","backdrop","keyboard","scroll","DefaultType","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_FOCUSIN","EVENT_CLICK_DATA_API","EVENT_CLICK_DISMISS","EVENT_KEYDOWN_DISMISS","Offcanvas","BaseComponent","constructor","element","config","_config","this","_getConfig","_isShown","_backdrop","_initializeBackDrop","_addEventListeners","NAME","toggle","relatedTarget","hide","show","EventHandler","trigger","_element","defaultPrevented","style","visibility","ScrollBarHelper","_enforceFocusOnElement","removeAttribute","setAttribute","classList","add","_queueCallback","off","document","blur","remove","reset","dispose","Manipulator","getDataAttributes","Backdrop","isVisible","isAnimated","rootElement","parentNode","clickCallback","on","event","target","contains","focus","key","each","data","getOrCreateInstance","undefined","startsWith","TypeError","includes","tagName","preventDefault","one","allReadyOpen","SelectorEngine","findOne","getInstance","window","find","forEach","el"],"mappings":"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"}