define ("core_course/editor",["exports","core/log","core_course/local/editor/mutations","core_course/local/editor/statemanager","core/ajax","core_course/events"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=g(b);c=g(c);d=g(d);e=g(e);f=g(f);function g(a){return a&&a.__esModule?a:{default:a}}function h(a){return l(a)||k(a)||j(a)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(a,b){if(!a)return;if("string"==typeof a)return m(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return m(a,b)}function k(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function l(a){if(Array.isArray(a))return m(a)}function m(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function n(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function o(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){n(h,d,e,f,g,"next",a)}function g(a){n(h,d,e,f,g,"throw",a)}f(void 0)})}}var x,y,z=new Set([]),A=new Map([]);function p(){return q.apply(this,arguments)}function q(){q=o(regeneratorRuntime.mark(function a(g){var h,i;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:x=c.default;document.addEventListener(f.default.statechanged,s);a.prev=2;a.next=5;return e.default.call([{methodname:"core_course_get_state",args:{courseid:g}}])[0];case 5:h=a.sent;i=JSON.parse(h);y=new d.default(r);y.setInitialState(i);a.next=15;break;case 11:a.prev=11;a.t0=a["catch"](2);b.default.error("EXCEPTION RAISED WHILE INIT COURSE EDITOR");b.default.error(a.t0);case 15:case"end":return a.stop();}}},a,null,[[2,11]])}));return q.apply(this,arguments)}function r(a,b,c){document.dispatchEvent(new CustomEvent(f.default.statechanged,{bubbles:!0,detail:{action:a,state:b,element:c}}))}function s(a){var c=a.detail.action;if(A.has(c)){A.get(c).forEach(function(d){try{b.default.debug("Executing \"".concat(d.name,"\" ").concat(c," watcher"));d.handler(a.detail)}catch(a){b.default.error("Component \"".concat(d.name,"\" error while watching ").concat(c));b.default.error(a)}})}}function t(a){b.default.error(a)}function u(){return y.state}function v(){var a,d,e=Array.prototype.slice.call(arguments);a=e[0];d=e.slice(1);try{var f,g=null!==(f=x[a])&&void 0!==f?f:c.default[a];g.apply(x,[y].concat(h(d)))}catch(a){b.default.error(a)}}function w(a){var b=a.getEventHandlers();for(var f in b){if(b.hasOwnProperty(f)){var c,d,e=null!==(c=A.get(f))&&void 0!==c?c:[];e.push({name:null!==(d=a.name)&&void 0!==d?d:"Unkown component",handler:b[f]});A.set(f,e)}}z.add(a);if(y!==void 0&&y.state!==void 0){if(b.state_loaded!==void 0){b.state_loaded({state:y.state})}}}a.default={init:p,setMutations:function(a){x=a},notifyError:t,getState:u,dispatch:v,registerComponent:w};return a.default});
//# sourceMappingURL=editor.min.js.map
