define ("core_course/local/editor/reactive",["exports","core/log","core_course/local/editor/statemanager"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return i(a)||h(a)||g(a)||f()}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(a,b){if(!a)return;if("string"==typeof a)return j(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return j(a,b)}function h(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function i(a){if(Array.isArray(a))return j(a)}function j(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function k(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function l(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function m(a,b,c){if(b)l(a.prototype,b);if(c)l(a,c);return a}var n=function(){function a(b){var d;k(this,a);if(b.name===void 0){throw new Error("Reactivity name required")}if(b.eventname===void 0||b.eventdispatch===void 0){throw new Error("Reactivity event required")}this.name=b.name;this.eventname=b.eventname;this.eventdispatch=b.eventdispatch;this.statemanager=new c.default(this.eventdispatch);this.watchers=new Map([]);this.components=new Set([]);this.mutations=null!==(d=b.mutations)&&void 0!==d?d:{};document.addEventListener(this.eventname,this.callWatchersHandler.bind(this))}m(a,[{key:"callWatchersHandler",value:function callWatchersHandler(a){var c=a.detail.action;if(this.watchers.has(c)){this.watchers.get(c).forEach(function(d){try{b.default.debug("Executing \"".concat(d.name,"\" ").concat(c," watcher"));d.handler(a.detail)}catch(a){b.default.error("Component \"".concat(d.name,"\" error while watching ").concat(c));b.default.error(a)}})}}},{key:"setInitialState",value:function setInitialState(a){this.statemanager.setInitialState(a)}},{key:"addMutations",value:function addMutations(a){for(var b in a){if(a.hasOwnProperty(b)){this.mutations[b]=a[b]}}}},{key:"getState",value:function getState(){return this.statemanager.state}},{key:"registerComponent",value:function registerComponent(a){var b=this,c=a.getEventHandlers();c.forEach(function(c){var d,e,f=c.watch,g=c.handler,h=null!==(d=a.name)&&void 0!==d?d:"Unkown component";if(f===void 0){throw new Error("Empty watcher in ".concat(h))}if(g===void 0){throw new Error("Empty handler for watcher ".concat(f," in ").concat(h))}var i=null!==(e=b.watchers.get(f))&&void 0!==e?e:[];i.push({name:h,handler:g});b.watchers.set(f,i);if("state:loaded"==f&&b.statemanager!==void 0&&b.statemanager.state!==void 0){g({state:b.statemanager.state})}});this.components.add(a)}},{key:"dispatch",value:function dispatch(){for(var a,c,d=arguments.length,f=Array(d),g=0;g<d;g++){f[g]=arguments[g]}a=f[0];c=f.slice(1);if(this.mutations[a]===void 0){throw new Error("Unkown ".concat(a," mutation"))}try{var h=this.mutations[a];h.apply(this.mutations,[this.statemanager].concat(e(c)))}catch(c){b.default.error(c);throw new Error("Exception dispatching ".concat(a))}}}]);return a}();a.default=n;return a.default});
//# sourceMappingURL=reactive.min.js.map
