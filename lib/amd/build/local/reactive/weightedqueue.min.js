define("core/local/reactive/weightedqueue",["exports","core/utils"],(function(_exports,_utils){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;return _exports.default=
/**
   * A priority weighted execution queue.
   *
   * This class is used to sort the template components by weight
   * and prevent unnecessary template rendering.
   *
   * @module     core/local/reactive/weightedqueue
   * @copyright  2024 Ferran Recio <ferran@moodle.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
class{constructor(){this.queue=[],this.executeDebounce=(0,_utils.debounce)(this.execute.bind(this),100)}add(functionToExecute){let weight=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.queue.push({functionToExecute:functionToExecute,weight:weight})}_getWeightedQueue(){const result=this.queue.reduce(((acc,item)=>(acc[item.weight]||(acc[item.weight]=[]),acc[item.weight].push(item.functionToExecute),acc)),{});return Object.keys(result).sort(((a,b)=>a-b)).map((key=>result[key]))}execute(){const queue=this._getWeightedQueue();this.clear();const executeTopLevel=async pendingQueue=>{if(0===pendingQueue.length)return;const functions=pendingQueue.shift(),pendingPromises=[];for(const func of functions){const funcResult=func();funcResult instanceof Promise&&pendingPromises.push(funcResult)}await Promise.all(pendingPromises),executeTopLevel(pendingQueue)};executeTopLevel(queue)}clear(){this.queue=[]}},_exports.default}));

//# sourceMappingURL=weightedqueue.min.js.map