define("core/local/reactive/virtualdom",["exports","core/templates"],(function(_exports,_templates){var obj;function getnodeType(node){return node.nodeType==Node.ELEMENT_NODE?node.tagName.toLowerCase():node.nodeType}function clean(node){for(var n=0;n<node.childNodes.length;n++){var child=node.childNodes[n];child.nodeType===Node.COMMENT_NODE||child.nodeType===Node.TEXT_NODE&&!/\S/.test(child.nodeValue)&&child.nodeValue.includes("\n")?(node.removeChild(child),n--):child.nodeType===Node.ELEMENT_NODE&&clean(child)}}function parseHTML(html){let doc=(new DOMParser).parseFromString(html,"text/html");if(clean(doc.body),1!=doc.body.childElementCount)throw new Error("The HTML must have only one root element");return doc.body.firstChild}function attrbutesIndex(element){var attributes={};if(null==element.attributes)return attributes;for(var i=0,atts=element.attributes,n=atts.length;i<n;i++)attributes[atts[i].name]=atts[i].value;return attributes}function patchAttributes(vdom,dom){let vdomAttributes=attrbutesIndex(vdom),domAttributes=attrbutesIndex(dom);vdomAttributes!=domAttributes&&(Object.keys(vdomAttributes).forEach((key=>{dom.getAttribute(key)?dom.getAttribute(key)&&vdomAttributes[key]!=domAttributes[key]&&dom.setAttribute(key,vdomAttributes[key]):dom.setAttribute(key,vdomAttributes[key])})),Object.keys(domAttributes).forEach((key=>{vdom.getAttribute(key)||dom.removeAttribute(key)})))}function diff(vdom,dom){if(0==dom.hasChildNodes()&&1==vdom.hasChildNodes())for(var i=0;i<vdom.childNodes.length;i++)dom.append(vdom.childNodes[i].cloneNode(!0));else{if(vdom.isEqualNode(dom))return;if(dom.childNodes.length>vdom.childNodes.length){let count=dom.childNodes.length-vdom.childNodes.length;if(count>0)for(;count>0;count--)dom.childNodes[dom.childNodes.length-count].remove()}for(let i=0;i<vdom.childNodes.length;i++)null==dom.childNodes[i]?dom.append(vdom.childNodes[i].cloneNode(!0)):getnodeType(vdom.childNodes[i])==getnodeType(dom.childNodes[i])?vdom.childNodes[i].nodeType==Node.TEXT_NODE?vdom.childNodes[i].textContent!=dom.childNodes[i].textContent&&(dom.childNodes[i].textContent=vdom.childNodes[i].textContent):patchAttributes(vdom.childNodes[i],dom.childNodes[i]):dom.childNodes[i].replaceWith(vdom.childNodes[i].cloneNode(!0)),vdom.childNodes[i].nodeType!=Node.TEXT_NODE&&diff(vdom.childNodes[i],dom.childNodes[i])}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};var _default={applyTemplate:function(element,html,js){diff(parseHTML(html),element),_templates.default.runTemplateJS(js)}};
/**
   * TODO describe module virtualdom
   *
   * @module     core/local/reactive/virtualdom
   * @copyright  2024 Ferran Recio <ferran@moodle.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */return _exports.default=_default,_exports.default}));

//# sourceMappingURL=virtualdom.min.js.map