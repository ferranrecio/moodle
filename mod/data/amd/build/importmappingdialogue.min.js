define("mod_data/importmappingdialogue",["exports","core/notification","core/ajax","core/url","core/templates","core/modal"],(function(_exports,_notification,_ajax,_url,_templates,_modal){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript module for deleting a database as a preset.
   *
   * @module      mod_data/importmappingdialogue
   * @copyright   2022 Amaia Anabitarte <amaia@moodle.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=_interopRequireDefault(_notification),_ajax=_interopRequireDefault(_ajax),_url=_interopRequireDefault(_url),_templates=_interopRequireDefault(_templates),_modal=_interopRequireDefault(_modal);const selectors_selectPresetButton='input[name="selectpreset"]';_exports.init=()=>{registerEventListeners()};const registerEventListeners=()=>{document.addEventListener("click",(event=>{const usepreset=event.target.closest(selectors_selectPresetButton);usepreset&&(event.preventDefault(),mappingusepreset(usepreset))}))},mappingusepreset=usepreset=>{const presetName=usepreset.dataset.presetname,cmId=usepreset.dataset.cmid;(async function(cmId,presetName){var request={methodname:"mod_data_get_mapping_information",args:{cmid:cmId,import:presetName}};return _ajax.default.call([request])[0]})(cmId,presetName).then((result=>{if(result.data&&result.data.needsmapping){return result.data=addMappingButtons(result.data,cmId,presetName),_templates.default.render("mod_data/fields_mapping_modal",result.data).then((function(html){return new _modal.default(html)})).fail(_notification.default.exception).then((modal=>(modal.show(),modal))).fail(_notification.default.exception),result}window.location.href=_url.default.relativeUrl("mod/data/field.php",{id:cmId,mode:"usepreset",fullname:presetName},!1)}))},addMappingButtons=(data,cmId,presetName)=>{const cancelButton=_url.default.relativeUrl("mod/data/preset.php",{id:cmId},!1);data.cancel=cancelButton;const mapButton=_url.default.relativeUrl("mod/data/field.php",{id:cmId,fullname:presetName,mode:"usepreset",action:"select"},!1);data.mapfieldsbutton=mapButton;const applyButton=_url.default.relativeUrl("mod/data/field.php",{id:cmId,fullname:presetName,mode:"usepreset",action:"notmapping"},!1);return data.applybutton=applyButton,data}}));

//# sourceMappingURL=importmappingdialogue.min.js.map